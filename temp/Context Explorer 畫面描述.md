# Context Explorer 畫面描述

## 畫面規格：Copy for AI - Context Explorer (VSCode Panel View 版本)

**目的：**

讓使用者在 VSCode 中選取 **目前專案** 的檔案，以便複製其內容作為 AI 模型的上下文 (context)。此視窗將作為 VSCode 的 **側邊欄面板 (Panel View)** 呈現。

**整體佈局：**

VSCode 側邊欄面板 (Panel View)，垂直堆疊佈局，由上而下分為五個主要區塊：

1. **標題列 (Panel Header)**
2. **篩選與搜尋列 (Filter & Search Bar)**
3. **工具列 (Toolbar)**
4. **檔案列表區塊 (File List Area)**
5. **底部摘要列含複製按鈕 (Footer Summary Bar)**

**區塊與元素詳細描述：**

### 1. 標題列 (Panel Header)

* **元素類型：** 容器 (Panel Header)
* **位置：** 視窗頂部 (Panel View 的頂部)
* **元素：**
    * **標題文字：** "Copy for AI - Context Explorer"
        * **樣式：**  Panel Header 標準樣式。

### 2. 篩選與搜尋列 (Filter & Search Bar)

* **元素類型：** 容器 (Container)
* **位置：** 標題列下方
* **元素：**
    * **專案資訊顯示：** (文字) 例如 "copy-for-ai"，顯示目前開啟的專案名稱
        * **功能：** 顯示目前的專案資訊。
    * **搜尋輸入框：** (文字輸入框) 預設文字 "Search files"
        * **功能：** 允許使用者輸入關鍵字搜尋檔案。
        * **行為：** 輸入時即時過濾檔案清單，根據檔案名稱進行模糊搜尋。
    * **清除搜尋按鈕 (X 圖示)：** (按鈕)
        * **功能：** 清除搜尋框內容。
        * **行為：** 點擊後清空搜尋框並重置檔案列表。

### 3. 工具列 (Toolbar)

* **元素類型：** 容器 (Container)
* **位置：** 篩選與搜尋列下方
* **元素：**
    * **篩選已選取檔案開關：** (Toggle Button) 文字標籤 "Show Selected Only"
        * **功能：**  切換檔案列表顯示模式 (顯示所有檔案/僅顯示已選取檔案)。
        * **樣式：**  Toggle Button 樣式，高亮指示目前篩選狀態。
    * **全選按鈕：** (按鈕) "Select All"
        * **功能：** 選取所有可見檔案。
        * **行為：** 點擊後勾選所有當前可見的檔案。
    * **取消全選按鈕：** (按鈕) "Deselect All"
        * **功能：** 取消所有已選取的檔案。
    * **展開全部按鈕：** (按鈕) 圖示或 "Expand All"
        * **功能：** 展開所有資料夾。
    * **摺疊全部按鈕：** (按鈕) 圖示或 "Collapse All"
        * **功能：** 摺疊所有資料夾。
    * **格式選擇下拉選單：** (Dropdown)
        * **功能：** 選擇輸出格式 (Markdown、XML、JSON、Custom)。
        * **預設值：** 採用 copyForAI.outputFormat 的設定。

### 4. 檔案列表區塊 (File List Area)

* **元素類型：** 樹狀列表 (Tree View / List View)
* **位置：** 工具列下方，底部摘要列上方
* **初始狀態：** 預設展開根目錄，其他資料夾摺疊
* **排除規則：** 自動排除 node_modules、.git、.vscode 等常見非程式碼資料夾
* **元素 (每行)：**
    * **選取框 (Checkbox)：** (Checkbox)
        * **功能：** 選取/取消選取檔案或資料夾。
        * **行為：** 選取資料夾時自動連帶選取所有子檔案；取消選取資料夾時自動取消選取所有子檔案。
    * **展開/摺疊指示符號：** (圖示) (僅資料夾)
        * **功能：** 展開/摺疊資料夾，顯示子項目。
        * **行為：** 點擊後展開或摺疊資料夾，狀態會被記憶。
    * **資料夾/檔案圖示：** (圖示)
        * **功能：** 區分資料夾和不同類型的檔案。
        * **樣式：** 採用 VSCode 檔案圖示主題，與檔案總管一致。
    * **檔案/資料夾名稱：** (文字標籤)
        * **功能：** 顯示檔案或資料夾名稱。
    * **檔案大小/tokens數量：** (文字標籤) 例如 "1050(<1%)", "2001(2%)"
        * **功能：** 顯示檔案大小或估計的 tokens 數量及其占總容量的比例。
        * **位置：** 檔案名稱右側。

### 5. 底部摘要列含複製按鈕 (Footer Summary Bar)

* **元素類型：** 容器 (Container)
* **位置：** 視窗底部
* **元素：**
    * **選取檔案數量：** (文字標籤) 例如 "6 files selected"
        * **功能：** 顯示已選取的檔案總數。
    * **Tokens 預估進度條：** (進度條) - **預設隱藏，設定 tokens 上限後才顯示**
        * **功能：** 顯示目前選取檔案 tokens 總量佔上限的比例。
        * **行為：** 隨選取檔案數量變化即時更新。
    * **Tokens 預估總量：** (文字標籤) 例如 "1234 tokens estimated"
        * **功能：** 顯示目前選取檔案內容的預估 tokens 總量。
    * **複製按鈕：** (主要按鈕) "Copy to Clipboard"
        * **功能：** 將選取的所有檔案內容複製到剪貼簿。
        * **樣式：** 藍色主要按鈕樣式，明顯且易於識別。
        * **行為：** 點擊後開始複製處理，顯示進度指示器。

**交互流程與反饋：**

1. **複製過程：**
   - 點擊「Copy to Clipboard」按鈕後，顯示進度指示器 (Progress Bar)
   - 對於大型檔案，顯示處理進度百分比
   - 複製過程可通過 ESC 鍵取消

2. **複製成功：**
   - 顯示成功通知提示 "X files copied to clipboard (Y tokens)"
   - 提示可包含「在編輯器中預覽」選項

3. **複製失敗：**
   - 顯示錯誤通知，說明失敗原因
   - 針對超過大小限制的檔案，提供部分複製或分批複製選項

**鍵盤快捷鍵：**

* **選取/取消選取檔案：** Space
* **展開/摺疊資料夾：** Enter 或右箭頭/左箭頭
