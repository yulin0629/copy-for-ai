# Change Log

All notable changes to the "copy-for-ai" extension will be documented in this file.

Check [Keep a Changelog](http://keepachangelog.com/) for recommendations on how to structure this file.

## [0.1.8] - 2025-04-08
### 新增
- **程式碼片段支援:**
    - 新增從編輯器選取程式碼並透過右鍵選單「Add Snippet to Copy For AI Explorer」將其添加為可重複使用的片段。
    - Context Explorer 中新增獨立的「程式碼片段」可摺疊區塊，用於顯示和管理已儲存的片段。
    - 支援勾選、複製、預覽（點擊跳轉至原始碼位置）和移除程式碼片段。
    - 片段會儲存其來源檔案、行號、程式碼內容（可選擇是否包含註解）、語言 ID、預估 Tokens，以及可選的程式碼結構和引用資訊。
- **檔案編碼偵測:** 引入 `jschardet` 函式庫以改進讀取檔案內容時的編碼偵測能力。

### 改進
- **Context Explorer UI/UX:**
    - 將「檔案列表」和「程式碼片段」分為獨立的可摺疊區塊，改善介面組織。
    - 更新 WebView 介面樣式，更緊密地遵循 VS Code 佈景主題變數，提升視覺一致性。
    - 為列表項目、按鈕和訊息提示添加圖示 (Emojis)，提升可識別性。
    - 改善列表項目點擊延遲處理，區分單擊（預覽）和雙擊（未來可擴展）。
    - 最佳化訊息提示的顯示與互動。
- **程式碼結構與重構:**
    - **WebView:** 將前端 JavaScript 程式碼拆分為 `state.js`, `ui.js`, `events.js`, `vscodeApi.js` 等模組，提高可維護性。
    - **後端:** 將 `FileTreeService` 的職責拆分為 `FileSystemReader` (讀取與過濾)、`FileTreeBuilder` (建立樹狀結構與計算 Token)、`FileInfoReader` (讀取內容與取得語言 ID)，使架構更清晰。
- **建構流程:**
    - 重構 `esbuild.js`，為擴充功能主體和 WebView 分別進行建構，並改善靜態資源（如 CSS）的複製邏輯。
- **設定應用:**
    - `includeStructureInfo`, `includeRelatedImports`, `includeComments` 設定現在也適用於添加程式碼片段時的上下文分析。
    - `outputFormat` 設定現在也適用於從 Explorer 複製片段時的輸出格式。


## [0.1.7] - 2025-04-06
### 改進
- **增強 Context Explorer 多選互動：**
  - **視覺選取 (反白):**
    - 支援 Shift + Click 選取視覺範圍內的項目列。
    - 支援 Ctrl / Cmd + Click 選取多個非連續的項目列。
    - 點擊列表空白處可取消所有視覺選取。
  - **勾選檔案 (Checkbox):**
    - 支援 Shift + Click Checkbox 來批次勾選/取消勾選範圍內的檔案。
  - **點擊行為調整:** 單擊項目列（非 Checkbox 或展開圖示）主要用於視覺選取；點擊 Checkbox 則用於管理勾選狀態。
- **前端介面優化：**
  - 進行搜尋、清除篩選或切換「僅顯示已選」時，自動清除視覺選取狀態。
  - 優化列表渲染邏輯，在重新渲染後盡量保持滾動位置。
  - 當工作區無符合條件的檔案時，顯示更友善的提示訊息。
  - 統一檔案和資料夾的 Tokens 數量顯示格式。
- **新增支援:** 新增對 Razor (.razor, .cshtml) 和 Markdown (.md) 檔案的內容複製支援。 *(註：此項基於原 Changelog 描述，未在提供的 diff 中驗證)*

## [0.1.6] - 2025-03-31
### 改進
- **優化 Context Explorer 檔案監聽機制：**
  - 提升效能：避免被忽略的檔案（根據 `.gitignore` 或 `contextExplorer.excludePatterns` 設定）變更時觸發不必要的檔案列表刷新。
  - 即時更新忽略規則：新增對 `.gitignore` 檔案本身的監聽，在其內容變更時能自動重新載入最新的忽略規則。
  - 改善 UI 反饋：改進 WebView 在檔案列表更新時的介面提示，能更清楚地顯示觸發刷新的原因（例如：新檔案建立、`.gitignore` 更新等）。 *(註：此項基於原 Changelog 描述，未在提供的 diff 中驗證)*

## [0.1.5] - 2025-03-31

### 改進
- 改進 Context Explorer 的檔案搜尋功能：
  - 支援不區分大小寫搜尋。
  - 支援使用多個關鍵字（以空格分隔）搜尋檔案路徑。
  - 例如，現在可以輸入 "media main" 來找到 `media/contextExplorer/main.js`。

## [0.1.4] - 2025-03-10

### 新增
- 在 Context Explorer 中支援 Shift + Click 範圍選取檔案功能，可一次選取多個連續檔案，提升工作效率。
- 為檔案項目新增滑鼠懸停效果，提升使用者體驗。
- 支援點擊檔案列表整列來切換選取狀態，操作更為直覺。

### 改進
- 優化 Context Explorer 檔案監聽機制，僅在視圖可見時監聽檔案變更，減少資源消耗並改善潛在的列表排序問題。
- 重構檔案項目點擊處理邏輯，支援點擊整列選取/取消選取，更符合直覺操作。
- 改善檔案系統監視器的記憶體管理，正確釋放不再需要的資源。

## [0.1.3] - 2025-03-09

### 新增
- 修正 Context Explorer 按鈕點擊無反應問題

## [0.1.2] - 2025-03-09

### 新增
- 優化檔案瀏覽器狀態管理機制
- 新增右鍵選單功能，支援從檔案總管直接添加檔案/資料夾
- 支援從編輯器頁籤添加檔案

### 改進
- 重構狀態管理邏輯以提升程式碼可維護性
- 將 UI 狀態與檔案選擇狀態分開管理
- 簡化 WebView 和擴展端的狀態同步機制

## [0.1.1] - 2025-03-03

### 修正
- 修正跨平台檔案路徑分隔符號問題

## [0.1.0] - 2025-03-03

### 新增
- 新增會話管理機制以優化狀態持久化
- 新增 Context Explorer 檢視介面功能
- 優化 Context Explorer 檔案瀏覽器使用體驗
- 加強檔案排除規則與更新過濾機制

### 改進
- 將檔案系統操作抽離至 FileTreeService 類別
- 修正資料夾選取狀態與篩選邏輯
- 簡化設定面板，移除獨立視窗改用 VSCode 內建設定頁面
- 改善 VSCode 擴充套件開發設定

### 文件
- 更新 Context Explorer 需求項目狀態追蹤
- 更新 Context Explorer 需求與畫面設計文件
- 簡化 File Explorer 側邊欄介面說明文件
- 更新 Context Explorer 功能文件

## [0.0.3] - 2024-02-28

### 新增
- 新增是否包含註解的設定選項
- 增強註解移除功能，支援更多程式語言
- 改進程式碼格式化，保持更好的可讀性
- 新增註解篩選功能並改進格式化輸出

### 文件
- 修正 README.md 中的程式碼區塊格式
- 移除發佈指引並新增 Context Explorer 相關文件

## [0.0.2] - 2024-02-27

### 新增
- 程式碼上下文分析與輸出格式功能
- 輸出格式驗證和錯誤處理
- 開發指南文件

### 改進
- 完善開發流程說明
- 補充擴展打包與發佈指南

## [0.0.1] - 初始發布

### 新增
- 實作 AI 友善程式碼複製功能
- 新增多種程式碼複製方式
- 基本的複製功能（保持相對縮排、轉換為 Markdown 格式、包含文件路徑與行號）
- 增強複製功能（含上下文）
- 將快速入門指南翻譯為繁體中文
- 新增 LICENSE 與更新專案基礎設定